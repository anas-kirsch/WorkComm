<main class="chat-main">
  <section class="chat-search-bar">
    <input class="chat-search-input" (input)="onInput($event)" type="text"
      placeholder="Rechercher un utilisateur ..." />
    <button class="chat-search-btn">Rechercher</button>
  </section>

  <div class="search-results" *ngIf="foundUsers.length > 0">
    <ng-container *ngFor="let user of foundUsers; let i = index">
      <p class="search-results-item" (click)="friendService.showUserProfil(user)">
        {{ user.username }}
      </p>
    </ng-container>
  </div>
  <div class="search-results" *ngIf="foundUsers.length === 0">
  </div>


  <section class="chat-content">
    <aside class="chat-sidebar">
      <div class="sidebar-section" [class.open]="openSection === 'amis'">
        <div class="sidebar-header" (click)="openSection = openSection === 'amis' ? null : 'amis'">
          <span>Mes amis</span>
          <span class="arrow" [class.down]="openSection === 'amis'">&#9660;</span>
        </div>

        <ul class="sidebar-list" *ngIf="openSection === 'amis'">
          <li class="sidebar-list-item" *ngFor="let friend of myFriends">
            <img *ngIf="getFriendImage(friend)" [src]="getFriendImage(friend)" alt="Photo" width="32" height="32"
              style="border-radius:50%;margin-right:8px;">
            {{ friend.username }}
          </li>
        </ul>


      </div>

      <div class="sidebar-section" [class.open]="openSection === 'groupes'">
        <div class="sidebar-header" (click)="openSection = openSection === 'groupes' ? null : 'groupes'">
          <span>Mes groupes</span>
          <span class="arrow" [class.down]="openSection === 'groupes'">&#9660;</span>
        </div>
        <ul class="sidebar-list" *ngIf="openSection === 'groupes'">
          <!-- <li class="sidebar-list-item">Nom Groupe</li> -->
        </ul>
      </div>



      <div class="sidebar-section" [class.open]="openSection === 'recues'">
        <div class="sidebar-header" (click)="openSection = openSection === 'recues' ? null : 'recues'">
          <span>Demandes d'amis reçues</span>
          <span class="arrow" [class.down]="openSection === 'recues'">&#9660;</span>
        </div>
        <ul class="sidebar-list" *ngIf="openSection === 'recues'">
          <li class="sidebar-list-item" *ngFor="let request of friendRequests"
            style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
              <img *ngIf="request.imagePath?.imagePath" [src]="request.imagePath.imagePath" alt="Photo de profil"
                class="profile-picture" width="28" height="28"
                style="border-radius:50%;margin-right:8px;vertical-align:middle;" />
              {{ request.username }}
            </div>
            <div>
              <button class="btn-accept" (click)="acceptRequest(request.id)">Accepter</button>
              <button class="btn-decline" (click)="refuseRequest(request.id)">Refuser</button>
            </div>
          </li>
        </ul>
      </div>

      <div class="sidebar-section" [class.open]="openSection === 'envoyees'">
        <div class="sidebar-header" (click)="openSection = openSection === 'envoyees' ? null : 'envoyees'">
          <span>Demandes d'amis envoyées</span>
          <span class="arrow" [class.down]="openSection === 'envoyees'">&#9660;</span>
        </div>
        <ul class="sidebar-list" *ngIf="openSection === 'envoyees'">
          <!-- <li class="sidebar-list-item">Demande envoyée</li> -->
        </ul>
      </div>
    </aside>

    <section class="chat-messages">
      <div class="messages-header">
        <h2 class="messages-header-title" id="chat-text">Chat</h2>
      </div>
      <div class="messages-list">
        <!-- Messages ici -->
      </div>
      <div class="messages-input">
        <input class="messages-input-field" type="text" placeholder="Écrire un message..." />
        <button class="send-btn">Envoyer</button>
      </div>
    </section>
  </section>
</main>