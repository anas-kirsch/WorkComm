<main>
    <section class="inscription-form-container">
        <h2>Inscription</h2>
        <form [formGroup]="form" (ngSubmit)="onSubmitInscription()" class="inscription-form">
      <!-- Champ honeypot invisible pour détecter les bots -->
      <div class="form-group" style="display:none;">
        <label for="honeypot">Ne pas remplir</label>
        <input type="text" id="honeypot" name="honeypot" [(ngModel)]="honeypot" autocomplete="off" />
      </div>

            <div class="form-group">
                <label for="username">Nom d'utilisateur</label>
                <input type="text" id="username" formControlName="username" required>
                @if (form.get('username')?.touched && form.get('username')?.invalid) {
                  <div class="error">
                    @if (form.get('username')?.errors?.['required']) {
                      <span>Ce champ est requis.</span>
                    }
                    @if (form.get('username')?.errors?.['minlength']) {
                      <span>Minimum 3 caractères.</span>
                    }
                    @if (form.get('username')?.errors?.['pattern']) {
                      <span>Caractères autorisés : lettres, chiffres, _</span>
                    }
                  </div>
                }
            </div>

            <div class="form-group">
                <label for="email">Adresse mail</label>
                <input type="email" id="email" formControlName="email" required>
                @if (form.get('email')?.touched && form.get('email')?.invalid) {
                  <div class="error">
                    @if (form.get('email')?.errors?.['required']) {
                      <span>Ce champ est requis.</span>
                    }
                    @if (form.get('email')?.errors?.['email']) {
                      <span>Adresse mail invalide.</span>
                    }
                  </div>
                }
            </div>

            <div class="form-group">
                <label for="bio">Bio</label>
                <textarea id="bio" formControlName="bio" rows="3"></textarea>
            </div>

            <div class="form-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password" formControlName="password" required>
                @if (form.get('password')?.touched && form.get('password')?.invalid) {
                  <div class="error">
                    @if (form.get('password')?.errors?.['required']) {
                      <span>Ce champ est requis.</span>
                    }
                    @if (form.get('password')?.errors?.['pattern']) {
                      <span>Minimum 8 caractères, 1 majuscule, 1 minuscule, 1 chiffre.</span>
                    }
                  </div>
                }
            </div>

            <div class="form-group">
                <label for="confirmpassword">Confirmer le mot de passe</label>
                <input type="password" id="confirmpassword" formControlName="confirmpassword" required>
                @if (form.get('confirmpassword')?.touched && form.get('confirmpassword')?.invalid) {
                  <div class="error">
                    @if (form.get('confirmpassword')?.errors?.['required']) {
                      <span>Ce champ est requis.</span>
                    }
                  </div>
                }
                @if (form.touched && form.errors?.['notSame']) {
                  <div class="error">
                    <span>Les mots de passe ne correspondent pas.</span>
                  </div>
                }
            </div>

            <div class="form-group">
                <label for="picture">Photo de profil</label>
                <!-- <input type="file" id="picture" formControlName="picture" accept="image/*"> -->
                <input type="file" (change)="onFileSelected($event)" />
            </div>

            <button type="submit" class="cta" [disabled]="form.invalid">S'inscrire</button>
        </form>

        <div class="signup-invite">
              <span>Vous avez déjà un compte ? <a (click)="goConnexion()">Connectez-vous</a></span>
        </div>
    </section>
</main>

<app-footer-component></app-footer-component>